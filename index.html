<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>RDB2XLS Part2</title>
<link rel="stylesheet" type="text/css" href="style.css" />
<script src="dist/cpexcel.js"></script>
<script src="shim.js"></script>
<script src="dist/jszip.js"></script>
<script src="dist/xlsx.js"></script>
<script src="dist/FileSaver.min.js"></script>
<script src="dist/constants.js"></script>
<script src="dist/filehandling.js"></script>
<script src="dist/RDB2XLS_Phase2_ingest.js"></script>
<script src="dist/RDB2XLS_Phase2_output.js"></script>
<script src="dist/RDB2XLS_Phase2_helpers.js"></script>
</head>

<body>
	<noscript style="color: maroon">
	  <h2>JavaScript is disabled in your browser. Please enable.</h2>
	</noscript>

	<h1><img src="Logo.png" height="150" width="150"></h1>
	<div id="drop" onclick="document.getElementById('xlf').click()">Drop RDB2XLSX-created spreadsheet or qwsample file here
		<p id="orclick">... or click to get a file picker.</p>
	</div>

	<input type="file" style="display:none" multiple name="xlfile" id="xlf" />

	<div id="phase2" class="hidden">
		<h1>XLSX+QWSAMPLE&rArr;QWSAMPLE+QWRESULT</h1>
		<div id="checkarea">
			<h2>Files required:</h2>
			<input class="check" type="checkbox"  id="qwsamplefilecheckbox" disabled><span class="lbl">qwsample</span></input>
			<br>
			<input class = "check" type="checkbox" id="xlsxfilecheckbox" disabled><span class="lbl">xlsx file</span>
		</div>
	</div>

	<div id=statusArea class="hidden">
		<textarea id="statusOutput" readonly></textarea>
	</div>

	<div class="hidden">
		<pre id="updatedValuesTable" ></pre>
	</div>
	<br />

<script>
//globals
var newWS;
var oldWS;
var qwsample;
var updatedRows;
var xlsxReady = false;
var qwsampleReady = false;


let drop = document.getElementById('drop');
if(drop.addEventListener) {
	drop.addEventListener('dragenter', handleDragover, false);
	drop.addEventListener('dragover', handleDragover, false);
	drop.addEventListener('drop', handleDrop, false);
	drop.addEventListener('dragleave',handleDragLeave,false);
}

if(xlf.addEventListener) xlf.addEventListener('change', handleFile, false);
</script>
</body>
</html>
